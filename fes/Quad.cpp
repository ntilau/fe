#include "Quad.h"

Quad::Quad(size_t p)
{
    static double wq2_strang1[] =
    {
        1.666666666666667e-001,
        1.666666666666667e-001,
        1.666666666666667e-001
    };
    static double xq2_strang1[] =
    {
        6.666666666666666e-001,    1.666666666666667e-001,
        1.666666666666667e-001,    6.666666666666666e-001,
        1.666666666666667e-001,    1.666666666666667e-001
    };
    static double wq2_strang5[] =
    {
        5.497587182766100e-002,
        5.497587182766100e-002,
        5.497587182766100e-002,
        1.116907948390055e-001,
        1.116907948390055e-001,
        1.116907948390055e-001
    };
    static double xq2_strang5[] =
    {
        8.168475729804590e-001,    9.157621350977101e-002,
        9.157621350977101e-002,    8.168475729804590e-001,
        9.157621350977101e-002,    9.157621350977101e-002,
        1.081030181680700e-001,    4.459484909159650e-001,
        4.459484909159650e-001,    1.081030181680700e-001,
        4.459484909159650e-001,    4.459484909159650e-001
    };
    static double wq2_strang8[] =
    {

        1.029752523804435e-001,
        1.029752523804435e-001,
        1.029752523804435e-001,
        3.184570714311150e-002,
        3.184570714311150e-002,
        3.184570714311150e-002,
        3.184570714311150e-002,
        3.184570714311150e-002,
        3.184570714311150e-002
    };
    static double xq2_strang8[] =
    {
        1.249495032332320e-001,    4.375252483833840e-001,
        4.375252483833840e-001,    1.249495032332320e-001,
        4.375252483833840e-001,    4.375252483833840e-001,
        7.971126518600710e-001,    1.654099273898410e-001,
        7.971126518600710e-001,    3.747742075008800e-002,
        1.654099273898410e-001,    7.971126518600710e-001,
        1.654099273898410e-001,    3.747742075008800e-002,
        3.747742075008800e-002,    7.971126518600710e-001,
        3.747742075008800e-002,    1.654099273898410e-001
    };
    static double wq2_strang9[] =
    {

        2.542245318510350e-002,
        2.542245318510350e-002,
        2.542245318510350e-002,
        5.839313786318950e-002,
        5.839313786318950e-002,
        5.839313786318950e-002,
        4.142553780918700e-002,
        4.142553780918700e-002,
        4.142553780918700e-002,
        4.142553780918700e-002,
        4.142553780918700e-002,
        4.142553780918700e-002
    };
    static double xq2_strang9[] =
    {
        8.738219710169960e-001,    6.308901449150201e-002,
        6.308901449150201e-002,    8.738219710169960e-001,
        6.308901449150201e-002,    6.308901449150201e-002,
        2.492867451709100e-001,    5.014265096581790e-001,
        5.014265096581790e-001,    2.492867451709100e-001,
        2.492867451709100e-001,    2.492867451709100e-001,
        6.365024991213990e-001,    3.103524510337850e-001,
        6.365024991213990e-001,    5.314504984481600e-002,
        3.103524510337850e-001,    6.365024991213990e-001,
        3.103524510337850e-001,    5.314504984481600e-002,
        5.314504984481600e-002,    6.365024991213990e-001,
        5.314504984481600e-002,    3.103524510337850e-001
    };
    static double wq2_gauss64[] =
    {
        1.667837031338886e-004,
        3.663940405745523e-004,
        5.168617270839625e-004,
        5.975562492075965e-004,
        5.975562492075965e-004,
        5.168617270839625e-004,
        3.663940405745523e-004,
        1.667837031338886e-004,
        9.031054597217305e-004,
        1.983961575590834e-003,
        2.798718573097116e-003,
        3.235665721590320e-003,
        3.235665721590320e-003,
        2.798718573097116e-003,
        1.983961575590834e-003,
        9.031054597217305e-004,
        2.299877901507876e-003,
        5.052421437633695e-003,
        7.127308255659340e-003,
        8.240052155199089e-003,
        8.240052155199089e-003,
        7.127308255659340e-003,
        5.052421437633695e-003,
        2.299877901507876e-003,
        4.008629765578365e-003,
        8.806244431439575e-003,
        1.242272035543997e-002,
        1.436220519254210e-002,
        1.436220519254210e-002,
        1.242272035543997e-002,
        8.806244431439575e-003,
        4.008629765578365e-003,
        5.367509486785310e-003,
        1.179146074665802e-002,
        1.663388071706455e-002,
        1.923082876949213e-002,
        1.923082876949213e-002,
        1.663388071706455e-002,
        1.179146074665802e-002,
        5.367509486785310e-003,
        5.694398702263345e-003,
        1.250957803407126e-002,
        1.764690849677194e-002,
        2.040201450189345e-002,
        2.040201450189345e-002,
        1.764690849677194e-002,
        1.250957803407126e-002,
        5.694398702263345e-003,
        4.611922695642696e-003,
        1.013157136772235e-002,
        1.429232164088616e-002,
        1.652369611574880e-002,
        1.652369611574880e-002,
        1.429232164088616e-002,
        1.013157136772235e-002,
        4.611922695642696e-003,
        2.254906357960856e-003,
        4.953626979653353e-003,
        6.987941703468780e-003,
        8.078927138917015e-003,
        8.078927138917015e-003,
        6.987941703468780e-003,
        4.953626979653353e-003,
        2.254906357960856e-003
    };
    static double xq2_gauss64[] =
    {
        9.553660447100000e-001,    8.862103848242247e-004,
        9.553660447100000e-001,    4.537789678039195e-003,
        9.553660447100000e-001,    1.058868260117431e-002,
        9.553660447100000e-001,    1.822327082910602e-002,
        9.553660447100000e-001,    2.641068446089399e-002,
        9.553660447100000e-001,    3.404527268882569e-002,
        9.553660447100000e-001,    4.009616561196080e-002,
        9.553660447100000e-001,    4.374774490517578e-002,
        8.556337429600001e-001,    2.866402391985981e-003,
        8.556337429600001e-001,    1.467724979327651e-002,
        8.556337429600001e-001,    3.424855503358430e-002,
        8.556337429600001e-001,    5.894224214571626e-002,
        8.556337429600001e-001,    8.542401489428375e-002,
        8.556337429600001e-001,    1.101177020064157e-001,
        8.556337429600001e-001,    1.296890072467235e-001,
        8.556337429600001e-001,    1.414998546480140e-001,
        7.131752428600000e-001,    5.694926133044352e-003,
        7.131752428600000e-001,    2.916054411712861e-002,
        7.131752428600000e-001,    6.804452564827500e-002,
        7.131752428600000e-001,    1.171055801775613e-001,
        7.131752428600000e-001,    1.697191769624387e-001,
        7.131752428600000e-001,    2.187802314917250e-001,
        7.131752428600000e-001,    2.576642130228714e-001,
        7.131752428600000e-001,    2.811298310069557e-001,
        5.451866848000000e-001,    9.030351006711630e-003,
        5.451866848000000e-001,    4.623939674940125e-002,
        5.451866848000000e-001,    1.078970888004545e-001,
        5.451866848000000e-001,    1.856923986620134e-001,
        5.451866848000000e-001,    2.691209165379867e-001,
        5.451866848000000e-001,    3.469162263995455e-001,
        5.451866848000000e-001,    4.085739184505988e-001,
        5.451866848000000e-001,    4.457829641932884e-001,
        3.719321645800000e-001,    1.247033193690498e-002,
        3.719321645800000e-001,    6.385362269957357e-002,
        3.719321645800000e-001,    1.489989161403976e-001,
        3.719321645800000e-001,    2.564292182833579e-001,
        3.719321645800000e-001,    3.716386171366422e-001,
        3.719321645800000e-001,    4.790689192796024e-001,
        3.719321645800000e-001,    5.642142127204264e-001,
        3.719321645800000e-001,    6.155975034830951e-001,
        2.143084794000000e-001,    1.559996151584746e-002,
        2.143084794000000e-001,    7.987871227492104e-002,
        2.143084794000000e-001,    1.863925811641285e-001,
        2.143084794000000e-001,    3.207842387034378e-001,
        2.143084794000000e-001,    4.649072818965623e-001,
        2.143084794000000e-001,    5.992989394358715e-001,
        2.143084794000000e-001,    7.058128083250790e-001,
        2.143084794000000e-001,    7.700915590841526e-001,
        9.132360790000005e-002,    1.804183496379599e-002,
        9.132360790000005e-002,    9.238218584838476e-002,
        9.132360790000005e-002,    2.155687489628060e-001,
        9.132360790000005e-002,    3.709968314854498e-001,
        9.132360790000005e-002,    5.376795606145502e-001,
        9.132360790000005e-002,    6.931076431371940e-001,
        9.132360790000005e-002,    8.162942062516152e-001,
        9.132360790000005e-002,    8.906345571362040e-001,
        1.777991514999999e-002,    1.950205026019779e-002,
        1.777991514999999e-002,    9.985913490381848e-002,
        1.777991514999999e-002,    2.330157982952792e-001,
        1.777991514999999e-002,    4.010234473667467e-001,
        1.777991514999999e-002,    5.811966374832533e-001,
        1.777991514999999e-002,    7.492042865547208e-001,
        1.777991514999999e-002,    8.823609499461815e-001,
        1.777991514999999e-002,    9.627180345898023e-001
    };
    static double wq3_keast1[] =
    {
        4.166666666666666e-002,
        4.166666666666666e-002,
        4.166666666666666e-002,
        4.166666666666666e-002
    };
    static double xq3_keast1[] =
    {
        5.854101966249685e-001,    1.381966011250105e-001,    1.381966011250105e-001,
        1.381966011250105e-001,    1.381966011250105e-001,    1.381966011250105e-001,
        1.381966011250105e-001,    1.381966011250105e-001,    5.854101966249685e-001,
        1.381966011250105e-001,    5.854101966249685e-001,    1.381966011250105e-001
    };
    static double wq3_keast4[] =
    {
        -1.315555555555555e-002,
        7.622222222222217e-003,
        7.622222222222217e-003,
        7.622222222222217e-003,
        7.622222222222217e-003,
        2.488888888888888e-002,
        2.488888888888888e-002,
        2.488888888888888e-002,
        2.488888888888888e-002,
        2.488888888888888e-002,
        2.488888888888888e-002
    };
    static double xq3_keast4[] =
    {
        2.500000000000000e-001,    2.500000000000000e-001,    2.500000000000000e-001,
        7.857142857142857e-001,    7.142857142857140e-002,    7.142857142857140e-002,
        7.142857142857140e-002,    7.142857142857140e-002,    7.142857142857140e-002,
        7.142857142857140e-002,    7.142857142857140e-002,    7.857142857142857e-001,
        7.142857142857140e-002,    7.857142857142857e-001,    7.142857142857140e-002,
        1.005964238332008e-001,    3.994035761667992e-001,    3.994035761667992e-001,
        3.994035761667992e-001,    1.005964238332008e-001,    3.994035761667992e-001,
        3.994035761667992e-001,    3.994035761667992e-001,    1.005964238332008e-001,
        3.994035761667992e-001,    1.005964238332008e-001,    1.005964238332008e-001,
        1.005964238332008e-001,    3.994035761667992e-001,    1.005964238332008e-001,
        1.005964238332008e-001,    1.005964238332008e-001,    3.994035761667992e-001
    };
    static double wq3_keast7[] =
    {
        6.653791709694645e-003,
        6.653791709694645e-003,
        6.653791709694645e-003,
        6.653791709694645e-003,
        1.679535175886776e-003,
        1.679535175886776e-003,
        1.679535175886776e-003,
        1.679535175886776e-003,
        9.226196923942399e-003,
        9.226196923942399e-003,
        9.226196923942399e-003,
        9.226196923942399e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003,
        8.035714285714283e-003
    };
    static double xq3_keast7[] =
    {
        3.561913862225449e-001,    2.146028712591517e-001,    2.146028712591517e-001,
        2.146028712591517e-001,    2.146028712591517e-001,    2.146028712591517e-001,
        2.146028712591517e-001,    2.146028712591517e-001,    3.561913862225449e-001,
        2.146028712591517e-001,    3.561913862225449e-001,    2.146028712591517e-001,
        8.779781243961660e-001,    4.067395853461134e-002,    4.067395853461134e-002,
        4.067395853461134e-002,    4.067395853461134e-002,    4.067395853461134e-002,
        4.067395853461134e-002,    4.067395853461134e-002,    8.779781243961660e-001,
        4.067395853461134e-002,    8.779781243961660e-001,    4.067395853461134e-002,
        3.298632957317306e-002,    3.223378901422757e-001,    3.223378901422757e-001,
        3.223378901422757e-001,    3.223378901422757e-001,    3.223378901422757e-001,
        3.223378901422757e-001,    3.223378901422757e-001,    3.298632957317306e-002,
        3.223378901422757e-001,    3.298632957317306e-002,    3.223378901422757e-001,
        2.696723314583159e-001,    6.366100187501753e-002,    6.366100187501753e-002,
        6.366100187501753e-002,    2.696723314583159e-001,    6.366100187501753e-002,
        6.366100187501753e-002,    6.366100187501753e-002,    2.696723314583159e-001,
        6.030056647916491e-001,    6.366100187501753e-002,    6.366100187501753e-002,
        6.366100187501753e-002,    6.030056647916491e-001,    6.366100187501753e-002,
        6.366100187501753e-002,    6.366100187501753e-002,    6.030056647916491e-001,
        6.366100187501753e-002,    2.696723314583159e-001,    6.030056647916491e-001,
        2.696723314583159e-001,    6.030056647916491e-001,    6.366100187501753e-002,
        6.030056647916491e-001,    6.366100187501753e-002,    2.696723314583159e-001,
        6.366100187501753e-002,    6.030056647916491e-001,    2.696723314583159e-001,
        2.696723314583159e-001,    6.366100187501753e-002,    6.030056647916491e-001,
        6.030056647916491e-001,    2.696723314583159e-001,    6.366100187501753e-002

    };
    static double wq3_gauss64[] =
    {
        5.614254026695108e-005,
        2.337955152791081e-004,
        3.663457985554330e-004,
        2.439854216206055e-004,
        3.722170752562637e-004,
        1.550031090353915e-003,
        2.428820659384976e-003,
        1.617588723434514e-003,
        7.780094259316959e-004,
        3.239880378814610e-003,
        5.076729393991842e-003,
        3.381089578564928e-003,
        6.013729287201762e-004,
        2.504309443009024e-003,
        3.924126780763082e-003,
        2.613459007507406e-003,
        1.052539187783915e-004,
        4.383110215343272e-004,
        6.868112975047707e-004,
        4.574146739399298e-004,
        6.978185458062601e-004,
        2.905939875758182e-003,
        4.553461442867280e-003,
        3.032594380369394e-003,
        1.458582752694614e-003,
        6.074005640321845e-003,
        9.517660952894899e-003,
        6.338739326589168e-003,
        1.127431304213664e-003,
        4.694984969634421e-003,
        7.356805009082972e-003,
        4.899614459888752e-003,
        1.052539187783914e-004,
        4.383110215343269e-004,
        6.868112975047703e-004,
        4.574146739399296e-004,
        6.978185458062598e-004,
        2.905939875758180e-003,
        4.553461442867278e-003,
        3.032594380369392e-003,
        1.458582752694613e-003,
        6.074005640321842e-003,
        9.517660952894896e-003,
        6.338739326589164e-003,
        1.127431304213664e-003,
        4.694984969634419e-003,
        7.356805009082969e-003,
        4.899614459888750e-003,
        5.614254026695106e-005,
        2.337955152791080e-004,
        3.663457985554329e-004,
        2.439854216206054e-004,
        3.722170752562636e-004,
        1.550031090353915e-003,
        2.428820659384975e-003,
        1.617588723434513e-003,
        7.780094259316957e-004,
        3.239880378814610e-003,
        5.076729393991841e-003,
        3.381089578564926e-003,
        6.013729287201759e-004,
        2.504309443009023e-003,
        3.924126780763081e-003,
        2.613459007507405e-003
    };
    static double xq3_gauss64[] =
    {
        7.958514178967728e-001,    1.756168039625050e-001,    1.981013974700433e-003,
        7.958514178967728e-001,    1.191391592971237e-001,    5.902361000058099e-003,
        7.958514178967728e-001,    5.651710869940736e-002,    1.025032546082948e-002,
        7.958514178967728e-001,    1.165774066892342e-002,    1.336499411296590e-002,
        5.170472951043675e-001,    4.154553003749570e-001,    4.686469274784634e-003,
        5.170472951043675e-001,    2.818465778637800e-001,    1.396316928033902e-002,
        5.170472951043675e-001,    1.337020822679904e-001,    2.424911481807401e-002,
        5.170472951043675e-001,    2.757862597439703e-002,    3.161746210173187e-002,
        2.386007375518623e-001,    6.549862048169315e-001,    7.388454838611979e-003,
        2.386007375518623e-001,    4.443453247774831e-001,    2.201363960428823e-002,
        2.386007375518623e-001,    2.107880663979872e-001,    3.822995078056707e-002,
        2.386007375518623e-001,    4.347909280428765e-002,    4.984652136888425e-002,
        4.850054944699722e-002,    8.185180164205335e-001,    9.233146216573627e-003,
        4.850054944699722e-002,    5.552859757470137e-001,    2.750983225384828e-002,
        4.850054944699722e-002,    2.634159753661123e-001,    4.777490464781691e-002,
        4.850054944699722e-002,    5.433461122723458e-002,    6.229180934845268e-002,
        7.958514178967728e-001,    1.756168039625050e-001,    9.415757216553931e-003,
        7.958514178967728e-001,    1.191391592971237e-001,    2.805391526296907e-002,
        7.958514178967728e-001,    5.651710869940736e-002,    4.871978550500960e-002,
        7.958514178967728e-001,    1.165774066892342e-002,    6.352380214147103e-002,
        5.170472951043675e-001,    4.154553003749570e-001,    2.227478324623352e-002,
        5.170472951043675e-001,    2.818465778637800e-001,    6.636692804612726e-002,
        5.170472951043675e-001,    1.337020822679904e-001,    1.152560157370178e-001,
        5.170472951043675e-001,    2.757862597439703e-002,    1.502777621740505e-001,
        2.386007375518623e-001,    6.549862048169315e-001,    3.511731762334666e-002,
        2.386007375518623e-001,    4.443453247774831e-001,    1.046308045343487e-001,
        2.386007375518623e-001,    2.107880663979872e-001,    1.817069135037572e-001,
        2.386007375518623e-001,    4.347909280428765e-002,    2.369204605788584e-001,
        4.850054944699722e-002,    8.185180164205335e-001,    4.388513368935081e-002,
        4.850054944699722e-002,    5.552859757470137e-001,    1.307542020795334e-001,
        4.850054944699722e-002,    2.634159753661123e-001,    2.270740686096784e-001,
        4.850054944699722e-002,    5.433461122723458e-002,    2.960729004920767e-001,
        7.958514178967728e-001,    1.756168039625050e-001,    1.911602092416825e-002,
        7.958514178967728e-001,    1.191391592971237e-001,    5.695550754313444e-002,
        7.958514178967728e-001,    5.651710869940736e-002,    9.891168789881023e-002,
        7.958514178967728e-001,    1.165774066892342e-002,    1.289670392928327e-001,
        5.170472951043675e-001,    4.154553003749570e-001,    4.522262127444197e-002,
        5.170472951043675e-001,    2.818465778637800e-001,    1.347391989857251e-001,
        5.170472951043675e-001,    1.337020822679904e-001,    2.339946068906244e-001,
        5.170472951043675e-001,    2.757862597439703e-002,    3.050963167471849e-001,
        2.386007375518623e-001,    6.549862048169315e-001,    7.129574000785965e-002,
        2.386007375518623e-001,    4.443453247774831e-001,    2.124231331363059e-001,
        2.386007375518623e-001,    2.107880663979872e-001,    3.689042825463934e-001,
        2.386007375518623e-001,    4.347909280428765e-002,    4.809997090649917e-001,
        4.850054944699722e-002,    8.185180164205335e-001,    8.909630044311860e-002,
        4.850054944699722e-002,    5.552859757470137e-001,    2.654592727264558e-001,
        4.850054944699722e-002,    2.634159753661123e-001,    4.610094065772121e-001,
        4.850054944699722e-002,    5.433461122723458e-002,    6.010919388336915e-001,
        7.958514178967728e-001,    1.756168039625050e-001,    2.655076416602175e-002,
        7.958514178967728e-001,    1.191391592971237e-001,    7.910706180604540e-002,
        7.958514178967728e-001,    5.651710869940736e-002,    1.373811479429903e-001,
        7.958514178967728e-001,    1.165774066892342e-002,    1.791258473213379e-001,
        5.170472951043675e-001,    4.154553003749570e-001,    6.281093524589085e-002,
        5.170472951043675e-001,    2.818465778637800e-001,    1.871429577515134e-001,
        5.170472951043675e-001,    1.337020822679904e-001,    3.250015078095681e-001,
        5.170472951043675e-001,    2.757862597439703e-002,    4.237566168195036e-001,
        2.386007375518623e-001,    6.549862048169315e-001,    9.902460279259431e-002,
        2.386007375518623e-001,    4.443453247774831e-001,    2.950402980663664e-001,
        2.386007375518623e-001,    2.107880663979872e-001,    5.123812452695834e-001,
        2.386007375518623e-001,    4.347909280428765e-002,    6.680736482749657e-001,
        4.850054944699722e-002,    8.185180164205335e-001,    1.237482879158958e-001,
        4.850054944699722e-002,    5.552859757470137e-001,    3.687036425521408e-001,
        4.850054944699722e-002,    2.634159753661123e-001,    6.403085705390735e-001,
        4.850054944699722e-002,    5.433461122723458e-002,    8.348730299773155e-001
    };
    switch(p)
    {
    case 1:
        wq2.resize(3);
        xq2.resize(3,2);
        wq3.resize(4,1);
        xq3.resize(4,3);
        wq2 = arma::vec(wq2_strang1, 3, false);
        xq2 = arma::mat(xq2_strang1, 2, 3, false).st();
        wq3 = arma::mat(wq3_keast1, 1, 4, false).st();
        xq3 = arma::mat(xq3_keast1, 3, 4, false).st();
        break;
    case 2:
        wq2.resize(6);
        xq2.resize(6,2);
        wq3.resize(11,1);
        xq3.resize(11,3);
        wq2 = arma::vec(wq2_strang5, 6, false);
        xq2 = arma::mat(xq2_strang5, 2, 6, false).st();
        wq3 = arma::mat(wq3_keast4, 1, 11, false).st();
        xq3 = arma::mat(xq3_keast4, 3, 11, false).st();
        break;
    case 3:
        // strang8 is not enough
        wq2.resize(12);
        xq2.resize(12,2);
        wq3.resize(24,1);
        xq3.resize(24,3);
        wq2 = arma::vec(wq2_strang9, 12, false);
        xq2 = arma::mat(xq2_strang9, 2, 12, false).st();
        wq3 = arma::mat(wq3_keast7, 1, 24, false).st();
        xq3 = arma::mat(xq3_keast7, 3, 24, false).st();
    case 4:
        // GAUSS 64 points for very high accuracy or higher order functions
        wq2.resize(64);
        xq2.resize(64,2);
        wq3.resize(64,1);
        xq3.resize(64,3);
        wq2 = arma::vec(wq2_gauss64, 64, false);
        xq2 = arma::mat(xq2_gauss64, 2, 64, false).st();
        wq3 = arma::mat(wq3_gauss64, 1, 64, false).st();
        xq3 = arma::mat(xq3_gauss64, 3, 64, false).st();
        break;
    default:
        throw std::string("Quadrature order not yet implemented");
    }
}

Quad::~Quad()
{
    xq3.clear();
    xq2.clear();
    wq3.clear();
    wq2.clear();
}
